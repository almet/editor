(function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}g.KintoClient = f()}})(function(){var define,module,exports;return (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
function EventEmitter(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function isFunction(e){return"function"==typeof e}function isNumber(e){return"number"==typeof e}function isObject(e){return"object"==typeof e&&null!==e}function isUndefined(e){return void 0===e}module.exports=EventEmitter,EventEmitter.EventEmitter=EventEmitter,EventEmitter.prototype._events=void 0,EventEmitter.prototype._maxListeners=void 0,EventEmitter.defaultMaxListeners=10,EventEmitter.prototype.setMaxListeners=function(e){if(!isNumber(e)||0>e||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},EventEmitter.prototype.emit=function(e){var t,n,i,s,r,o;if(this._events||(this._events={}),"error"===e&&(!this._events.error||isObject(this._events.error)&&!this._events.error.length)){if(t=arguments[1],t instanceof Error)throw t;throw TypeError('Uncaught, unspecified "error" event.')}if(n=this._events[e],isUndefined(n))return!1;if(isFunction(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:s=Array.prototype.slice.call(arguments,1),n.apply(this,s)}else if(isObject(n))for(s=Array.prototype.slice.call(arguments,1),o=n.slice(),i=o.length,r=0;i>r;r++)o[r].apply(this,s);return!0},EventEmitter.prototype.addListener=function(e,t){var n;if(!isFunction(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,isFunction(t.listener)?t.listener:t),this._events[e]?isObject(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,isObject(this._events[e])&&!this._events[e].warned&&(n=isUndefined(this._maxListeners)?EventEmitter.defaultMaxListeners:this._maxListeners,n&&n>0&&this._events[e].length>n&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace())),this},EventEmitter.prototype.on=EventEmitter.prototype.addListener,EventEmitter.prototype.once=function(e,t){function n(){this.removeListener(e,n),i||(i=!0,t.apply(this,arguments))}if(!isFunction(t))throw TypeError("listener must be a function");var i=!1;return n.listener=t,this.on(e,n),this},EventEmitter.prototype.removeListener=function(e,t){var n,i,s,r;if(!isFunction(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(n=this._events[e],s=n.length,i=-1,n===t||isFunction(n.listener)&&n.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(isObject(n)){for(r=s;r-- >0;)if(n[r]===t||n[r].listener&&n[r].listener===t){i=r;break}if(0>i)return this;1===n.length?(n.length=0,delete this._events[e]):n.splice(i,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},EventEmitter.prototype.removeAllListeners=function(e){var t,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(n=this._events[e],isFunction(n))this.removeListener(e,n);else if(n)for(;n.length;)this.removeListener(e,n[n.length-1]);return delete this._events[e],this},EventEmitter.prototype.listeners=function(e){var t;return t=this._events&&this._events[e]?isFunction(this._events[e])?[this._events[e]]:this._events[e].slice():[]},EventEmitter.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(isFunction(t))return 1;if(t)return t.length}return 0},EventEmitter.listenerCount=function(e,t){return e.listenerCount(t)};

},{}],2:[function(require,module,exports){
require("whatwg-fetch"),module.exports=self.fetch.bind(self);

},{"whatwg-fetch":3}],3:[function(require,module,exports){
!function(t){"use strict";function e(t){if("string"!=typeof t&&(t=String(t)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(t))throw new TypeError("Invalid character in header field name");return t.toLowerCase()}function r(t){return"string"!=typeof t&&(t=String(t)),t}function o(t){this.map={},t instanceof o?t.forEach(function(t,e){this.append(e,t)},this):t&&Object.getOwnPropertyNames(t).forEach(function(e){this.append(e,t[e])},this)}function n(t){return t.bodyUsed?Promise.reject(new TypeError("Already read")):void(t.bodyUsed=!0)}function s(t){return new Promise(function(e,r){t.onload=function(){e(t.result)},t.onerror=function(){r(t.error)}})}function i(t){var e=new FileReader;return e.readAsArrayBuffer(t),s(e)}function a(t){var e=new FileReader;return e.readAsText(t),s(e)}function h(){return this.bodyUsed=!1,this._initBody=function(t){if(this._bodyInit=t,"string"==typeof t)this._bodyText=t;else if(c.blob&&Blob.prototype.isPrototypeOf(t))this._bodyBlob=t;else if(c.formData&&FormData.prototype.isPrototypeOf(t))this._bodyFormData=t;else if(t){if(!c.arrayBuffer||!ArrayBuffer.prototype.isPrototypeOf(t))throw new Error("unsupported BodyInit type")}else this._bodyText="";this.headers.get("content-type")||("string"==typeof t?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type&&this.headers.set("content-type",this._bodyBlob.type))},c.blob?(this.blob=function(){var t=n(this);if(t)return t;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this.blob().then(i)},this.text=function(){var t=n(this);if(t)return t;if(this._bodyBlob)return a(this._bodyBlob);if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)}):this.text=function(){var t=n(this);return t?t:Promise.resolve(this._bodyText)},c.formData&&(this.formData=function(){return this.text().then(f)}),this.json=function(){return this.text().then(JSON.parse)},this}function u(t){var e=t.toUpperCase();return y.indexOf(e)>-1?e:t}function d(t,e){e=e||{};var r=e.body;if(d.prototype.isPrototypeOf(t)){if(t.bodyUsed)throw new TypeError("Already read");this.url=t.url,this.credentials=t.credentials,e.headers||(this.headers=new o(t.headers)),this.method=t.method,this.mode=t.mode,r||(r=t._bodyInit,t.bodyUsed=!0)}else this.url=t;if(this.credentials=e.credentials||this.credentials||"omit",(e.headers||!this.headers)&&(this.headers=new o(e.headers)),this.method=u(e.method||this.method||"GET"),this.mode=e.mode||this.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&r)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(r)}function f(t){var e=new FormData;return t.trim().split("&").forEach(function(t){if(t){var r=t.split("="),o=r.shift().replace(/\+/g," "),n=r.join("=").replace(/\+/g," ");e.append(decodeURIComponent(o),decodeURIComponent(n))}}),e}function p(t){var e=new o,r=t.getAllResponseHeaders().trim().split("\n");return r.forEach(function(t){var r=t.trim().split(":"),o=r.shift().trim(),n=r.join(":").trim();e.append(o,n)}),e}function l(t,e){e||(e={}),this.type="default",this.status=e.status,this.ok=this.status>=200&&this.status<300,this.statusText=e.statusText,this.headers=e.headers instanceof o?e.headers:new o(e.headers),this.url=e.url||"",this._initBody(t)}if(!t.fetch){o.prototype.append=function(t,o){t=e(t),o=r(o);var n=this.map[t];n||(n=[],this.map[t]=n),n.push(o)},o.prototype["delete"]=function(t){delete this.map[e(t)]},o.prototype.get=function(t){var r=this.map[e(t)];return r?r[0]:null},o.prototype.getAll=function(t){return this.map[e(t)]||[]},o.prototype.has=function(t){return this.map.hasOwnProperty(e(t))},o.prototype.set=function(t,o){this.map[e(t)]=[r(o)]},o.prototype.forEach=function(t,e){Object.getOwnPropertyNames(this.map).forEach(function(r){this.map[r].forEach(function(o){t.call(e,o,r,this)},this)},this)};var c={blob:"FileReader"in t&&"Blob"in t&&function(){try{return new Blob,!0}catch(t){return!1}}(),formData:"FormData"in t,arrayBuffer:"ArrayBuffer"in t},y=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];d.prototype.clone=function(){return new d(this)},h.call(d.prototype),h.call(l.prototype),l.prototype.clone=function(){return new l(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new o(this.headers),url:this.url})},l.error=function(){var t=new l(null,{status:0,statusText:""});return t.type="error",t};var b=[301,302,303,307,308];l.redirect=function(t,e){if(-1===b.indexOf(e))throw new RangeError("Invalid status code");return new l(null,{status:e,headers:{location:t}})},t.Headers=o,t.Request=d,t.Response=l,t.fetch=function(t,e){return new Promise(function(r,o){function n(){return"responseURL"in i?i.responseURL:/^X-Request-URL:/m.test(i.getAllResponseHeaders())?i.getResponseHeader("X-Request-URL"):void 0}var s;s=d.prototype.isPrototypeOf(t)&&!e?t:new d(t,e);var i=new XMLHttpRequest;i.onload=function(){var t=1223===i.status?204:i.status;if(100>t||t>599)return void o(new TypeError("Network request failed"));var e={status:t,statusText:i.statusText,headers:p(i),url:n()},s="response"in i?i.response:i.responseText;r(new l(s,e))},i.onerror=function(){o(new TypeError("Network request failed"))},i.open(s.method,s.url,!0),"include"===s.credentials&&(i.withCredentials=!0),"responseType"in i&&c.blob&&(i.responseType="blob"),s.headers.forEach(function(t,e){i.setRequestHeader(e,t)}),i.send("undefined"==typeof s._bodyInit?null:s._bodyInit)})},t.fetch.polyfill=!0}}("undefined"!=typeof self?self:this);

},{}],4:[function(require,module,exports){
(function (global){
var rng;if(global.crypto&&crypto.getRandomValues){var _rnds8=new Uint8Array(16);rng=function(){return crypto.getRandomValues(_rnds8),_rnds8}}if(!rng){var _rnds=new Array(16);rng=function(){for(var r,n=0;16>n;n++)0===(3&n)&&(r=4294967296*Math.random()),_rnds[n]=r>>>((3&n)<<3)&255;return _rnds}}module.exports=rng;

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{}],5:[function(require,module,exports){
function parse(e,s,r){var t=s&&r||0,n=0;for(s=s||[],e.toLowerCase().replace(/[0-9a-f]{2}/g,function(e){16>n&&(s[t+n++]=_hexToByte[e])});16>n;)s[t+n++]=0;return s}function unparse(e,s){var r=s||0,t=_byteToHex;return t[e[r++]]+t[e[r++]]+t[e[r++]]+t[e[r++]]+"-"+t[e[r++]]+t[e[r++]]+"-"+t[e[r++]]+t[e[r++]]+"-"+t[e[r++]]+t[e[r++]]+"-"+t[e[r++]]+t[e[r++]]+t[e[r++]]+t[e[r++]]+t[e[r++]]+t[e[r++]]}function v1(e,s,r){var t=s&&r||0,n=s||[];e=e||{};var o=void 0!==e.clockseq?e.clockseq:_clockseq,a=void 0!==e.msecs?e.msecs:(new Date).getTime(),u=void 0!==e.nsecs?e.nsecs:_lastNSecs+1,c=a-_lastMSecs+(u-_lastNSecs)/1e4;if(0>c&&void 0===e.clockseq&&(o=o+1&16383),(0>c||a>_lastMSecs)&&void 0===e.nsecs&&(u=0),u>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");_lastMSecs=a,_lastNSecs=u,_clockseq=o,a+=122192928e5;var i=(1e4*(268435455&a)+u)%4294967296;n[t++]=i>>>24&255,n[t++]=i>>>16&255,n[t++]=i>>>8&255,n[t++]=255&i;var _=a/4294967296*1e4&268435455;n[t++]=_>>>8&255,n[t++]=255&_,n[t++]=_>>>24&15|16,n[t++]=_>>>16&255,n[t++]=o>>>8|128,n[t++]=255&o;for(var d=e.node||_nodeId,v=0;6>v;v++)n[t+v]=d[v];return s?s:unparse(n)}function v4(e,s,r){var t=s&&r||0;"string"==typeof e&&(s="binary"==e?new Array(16):null,e=null),e=e||{};var n=e.random||(e.rng||_rng)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,s)for(var o=0;16>o;o++)s[t+o]=n[o];return s||unparse(n)}for(var _rng=require("./rng"),_byteToHex=[],_hexToByte={},i=0;256>i;i++)_byteToHex[i]=(i+256).toString(16).substr(1),_hexToByte[_byteToHex[i]]=i;var _seedBytes=_rng(),_nodeId=[1|_seedBytes[0],_seedBytes[1],_seedBytes[2],_seedBytes[3],_seedBytes[4],_seedBytes[5]],_clockseq=16383&(_seedBytes[6]<<8|_seedBytes[7]),_lastMSecs=0,_lastNSecs=0,uuid=v4;uuid.v1=v1,uuid.v4=v4,uuid.parse=parse,uuid.unparse=unparse,module.exports=uuid;

},{"./rng":4}],6:[function(require,module,exports){
"use strict";function _interopRequireWildcard(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}function _interopRequireDefault(e){return e&&e.__esModule?e:{"default":e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _applyDecoratedDescriptor(e,t,r,s,n){var i={};return Object.keys(s).forEach(function(e){i[e]=s[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=r.slice().reverse().reduce(function(r,s){return s(e,t,r)||r},i),n&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(n):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}Object.defineProperty(exports,"__esModule",{value:!0}),exports["default"]=exports.SUPPORTED_PROTOCOL_VERSION=void 0;var _extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},_createClass=function(){function e(e,t){for(var r=0;r<t.length;r++){var s=t[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,r,s){return r&&e(t.prototype,r),s&&e(t,s),t}}(),_dec,_dec2,_dec3,_dec4,_dec5,_dec6,_dec7,_desc,_value,_class,_utils=require("./utils"),_http=require("./http"),_http2=_interopRequireDefault(_http),_endpoint=require("./endpoint"),_endpoint2=_interopRequireDefault(_endpoint),_requests=require("./requests"),requests=_interopRequireWildcard(_requests),_batch=require("./batch"),_bucket=require("./bucket"),_bucket2=_interopRequireDefault(_bucket),SUPPORTED_PROTOCOL_VERSION=exports.SUPPORTED_PROTOCOL_VERSION="v1",KintoClientBase=(_dec=(0,_utils.nobatch)("This operation is not supported within a batch operation."),_dec2=(0,_utils.nobatch)("This operation is not supported within a batch operation."),_dec3=(0,_utils.nobatch)("This operation is not supported within a batch operation."),_dec4=(0,_utils.nobatch)("This operation is not supported within a batch operation."),_dec5=(0,_utils.nobatch)("Can't use batch within a batch!"),_dec6=(0,_utils.capable)(["permissions_endpoint"]),_dec7=(0,_utils.support)("1.4","2.0"),_class=function(){function e(t){var r=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];if(_classCallCheck(this,e),"string"!=typeof t||!t.length)throw new Error("Invalid remote URL: "+t);"/"===t[t.length-1]&&(t=t.slice(0,-1)),this._backoffReleaseTime=null,this.defaultReqOptions={bucket:r.bucket||"default",headers:r.headers||{},safe:!!r.safe},this._options=r,this._requests=[],this._isBatch=!!r.batch,this.remote=t,this.serverInfo=null,this.events=r.events;var s=r.requestMode,n=r.timeout;this.http=new _http2["default"](this.events,{requestMode:s,timeout:n}),this._registerHTTPEvents()}return _createClass(e,[{key:"_registerHTTPEvents",value:function(){var e=this;this._isBatch||this.events.on("backoff",function(t){e._backoffReleaseTime=t})}},{key:"bucket",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],r=(0,_utils.omit)(this._getRequestOptions(t),"bucket");return new _bucket2["default"](this,e,r)}},{key:"_getRequestOptions",value:function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];return _extends({},this.defaultReqOptions,e,{batch:this._isBatch,headers:_extends({},this.defaultReqOptions.headers,e.headers)})}},{key:"fetchServerInfo",value:function(){var e=this,t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];return this.serverInfo?Promise.resolve(this.serverInfo):this.http.request(this.remote+(0,_endpoint2["default"])("root"),{headers:_extends({},this.defaultReqOptions.headers,t.headers)}).then(function(t){var r=t.json;return e.serverInfo=r,e.serverInfo})}},{key:"fetchServerSettings",value:function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];return this.fetchServerInfo(e).then(function(e){var t=e.settings;return t})}},{key:"fetchServerCapabilities",value:function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];return this.fetchServerInfo(e).then(function(e){var t=e.capabilities;return t})}},{key:"fetchUser",value:function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];return this.fetchServerInfo(e).then(function(e){var t=e.user;return t})}},{key:"fetchHTTPApiVersion",value:function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];return this.fetchServerInfo(e).then(function(e){var t=e.http_api_version;return t})}},{key:"_batchRequests",value:function(e){var t=this,r=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],s=_extends({},this.defaultReqOptions.headers,r.headers);return e.length?this.fetchServerSettings().then(function(n){var i=n.batch_max_requests;if(i&&e.length>i){var a=(0,_utils.partition)(e,i);return(0,_utils.pMap)(a,function(e){return t._batchRequests(e,r)})}return t.execute({path:(0,_endpoint2["default"])("batch"),method:"POST",headers:s,body:{defaults:{headers:s},requests:e}}).then(function(e){var t=e.responses;return t})}):Promise.resolve([])}},{key:"batch",value:function(t){var r=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],s=new e(this.remote,_extends({},this._options,this._getRequestOptions(r),{batch:!0})),n=void 0,i=void 0;r.bucket&&(n=s.bucket(r.bucket),r.collection&&(i=n.collection(r.collection)));var a=i||n||s;try{t(a)}catch(o){return Promise.reject(o)}return this._batchRequests(s._requests,r).then(function(e){return r.aggregate?(0,_batch.aggregate)(e,s._requests):e})}},{key:"execute",value:function(e){var t=this,r=arguments.length<=1||void 0===arguments[1]?{raw:!1,stringify:!0}:arguments[1],s=r.raw,n=r.stringify;if(this._isBatch){this._requests.push(e);var i="This result is generated from within a batch operation and should not be consumed.";return Promise.resolve(s?{json:i,headers:{get:function(){}}}:i)}var a=this.fetchServerSettings().then(function(r){return t.http.request(t.remote+e.path,_extends({},e,{body:n?JSON.stringify(e.body):e.body}))});return s?a:a.then(function(e){var t=e.json;return t})}},{key:"paginatedList",value:function(e,t){var r=this,s=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],n=_extends({sort:"-last_modified"},t),i=n.sort,a=n.filters,o=n.limit,u=n.pages,c=n.since;if(c&&"string"!=typeof c)throw new Error("Invalid value for since ("+c+"), should be ETag value.");var l=(0,_utils.qsify)(_extends({},a,{_sort:i,_limit:o,_since:c})),h=[],p=0,d=function(e){if(!e)throw new Error("Pagination exhausted.");return _(e)},_=function(e){var t=s.headers;return r.http.request(e,{headers:t}).then(v)},f=function(e,t,r,s){return{last_modified:r?r.replace(/"/g,""):r,data:e,next:d.bind(null,t),hasNextPage:!!t,totalRecords:s}},v=function(e){var t=e.headers,r=e.json,s=t.get("Next-Page"),n=t.get("ETag"),i=parseInt(t.get("Total-Records"),10);return u?(h=h.concat(r.data),p+=1,p>=u||!s?f(h,s,n,i):_(s)):f(r.data,s,n,i)};return this.execute(_extends({path:e+"?"+l},s),{raw:!0}).then(v)}},{key:"listPermissions",value:function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];return this.execute({path:(0,_endpoint2["default"])("permissions"),headers:_extends({},this.defaultReqOptions.headers,e.headers)})}},{key:"listBuckets",value:function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],t=(0,_endpoint2["default"])("bucket"),r=this._getRequestOptions(e);return this.paginatedList(t,e,r)}},{key:"createBucket",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];if(!e)throw new Error("A bucket id is required.");var r=this._getRequestOptions(t),s=r.data,n=void 0===s?{}:s,i=r.permissions;n.id=e;var a=(0,_endpoint2["default"])("bucket",e);return this.execute(requests.createRequest(a,{data:n,permissions:i},r))}},{key:"deleteBucket",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],r=(0,_utils.toDataBody)(e);if(!r.id)throw new Error("A bucket id is required.");var s=(0,_endpoint2["default"])("bucket",r.id),n={bucketObj:r},i=n.last_modified,a=this._getRequestOptions(_extends({last_modified:i},t));return this.execute(requests.deleteRequest(s,a))}},{key:"deleteBuckets",value:function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],t=this._getRequestOptions(e),r=(0,_endpoint2["default"])("bucket");return this.execute(requests.deleteRequest(r,t))}},{key:"remote",get:function(){return this._remote},set:function(e){var t=void 0;try{t=e.match(/\/(v\d+)\/?$/)[1]}catch(r){throw new Error("The remote URL must contain the version: "+e)}if(t!==SUPPORTED_PROTOCOL_VERSION)throw new Error("Unsupported protocol version: "+t);this._remote=e,this._version=t}},{key:"version",get:function(){return this._version}},{key:"backoff",get:function(){var e=(new Date).getTime();return this._backoffReleaseTime&&e<this._backoffReleaseTime?this._backoffReleaseTime-e:0}}]),e}(),_applyDecoratedDescriptor(_class.prototype,"fetchServerSettings",[_dec],Object.getOwnPropertyDescriptor(_class.prototype,"fetchServerSettings"),_class.prototype),_applyDecoratedDescriptor(_class.prototype,"fetchServerCapabilities",[_dec2],Object.getOwnPropertyDescriptor(_class.prototype,"fetchServerCapabilities"),_class.prototype),_applyDecoratedDescriptor(_class.prototype,"fetchUser",[_dec3],Object.getOwnPropertyDescriptor(_class.prototype,"fetchUser"),_class.prototype),_applyDecoratedDescriptor(_class.prototype,"fetchHTTPApiVersion",[_dec4],Object.getOwnPropertyDescriptor(_class.prototype,"fetchHTTPApiVersion"),_class.prototype),_applyDecoratedDescriptor(_class.prototype,"batch",[_dec5],Object.getOwnPropertyDescriptor(_class.prototype,"batch"),_class.prototype),_applyDecoratedDescriptor(_class.prototype,"listPermissions",[_dec6],Object.getOwnPropertyDescriptor(_class.prototype,"listPermissions"),_class.prototype),_applyDecoratedDescriptor(_class.prototype,"deleteBuckets",[_dec7],Object.getOwnPropertyDescriptor(_class.prototype,"deleteBuckets"),_class.prototype),_class);exports["default"]=KintoClientBase;

},{"./batch":7,"./bucket":8,"./endpoint":10,"./http":12,"./requests":14,"./utils":15}],7:[function(require,module,exports){
"use strict";function aggregate(){var e=arguments.length<=0||void 0===arguments[0]?[]:arguments[0],t=arguments.length<=1||void 0===arguments[1]?[]:arguments[1];if(e.length!==t.length)throw new Error("Responses length should match requests one.");var r={errors:[],published:[],conflicts:[],skipped:[]};return e.reduce(function(e,r,s){var o=r.status,n=t[s];if(o>=200&&400>o)e.published.push(r.body);else if(404===o){var a=n.path.match(/(buckets|groups|collections|records)\/([^\/]+)$/),u=3===a.length?a[2]:void 0;e.skipped.push({id:u,path:n.path,error:r.body})}else 412===o?e.conflicts.push({type:"outgoing",local:n.body,remote:r.body.details&&r.body.details.existing||null}):e.errors.push({path:n.path,sent:n,error:r.body});return e},r)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.aggregate=aggregate;

},{}],8:[function(require,module,exports){
"use strict";function _interopRequireWildcard(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function _interopRequireDefault(e){return e&&e.__esModule?e:{"default":e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _applyDecoratedDescriptor(e,t,n,i,r){var s={};return Object.keys(i).forEach(function(e){s[e]=i[e]}),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=n.slice().reverse().reduce(function(n,i){return i(e,t,n)||n},s),r&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(r):void 0,s.initializer=void 0),void 0===s.initializer&&(Object.defineProperty(e,t,s),s=null),s}Object.defineProperty(exports,"__esModule",{value:!0}),exports["default"]=void 0;var _extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},_createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),_dec,_desc,_value,_class,_utils=require("./utils"),_collection=require("./collection"),_collection2=_interopRequireDefault(_collection),_requests=require("./requests"),requests=_interopRequireWildcard(_requests),_endpoint=require("./endpoint"),_endpoint2=_interopRequireDefault(_endpoint),Bucket=(_dec=(0,_utils.capable)(["history"]),_class=function(){function e(t,n){var i=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];_classCallCheck(this,e),this.client=t,this.name=n,this.options=i,this._isBatch=!!i.batch}return _createClass(e,[{key:"_bucketOptions",value:function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],t=_extends({},this.options&&this.options.headers,e.headers);return _extends({},this.options,e,{headers:t,bucket:this.name,batch:this._isBatch})}},{key:"collection",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return new _collection2["default"](this.client,this,e,this._bucketOptions(t))}},{key:"getData",value:function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];return this.client.execute({path:(0,_endpoint2["default"])("bucket",this.name),headers:_extends({},this.options.headers,e.headers)}).then(function(e){return e.data})}},{key:"setData",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];if(!(0,_utils.isObject)(e))throw new Error("A bucket object is required.");var n=_extends({},e,{id:this.name}),i=n.id;"default"===n.id&&delete n.id;var r=(0,_endpoint2["default"])("bucket",i),s=t.permissions,a=_extends({},this._bucketOptions(t)),u=requests.updateRequest(r,{data:n,permissions:s},a);return this.client.execute(u)}},{key:"listHistory",value:function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],t=(0,_endpoint2["default"])("history",this.name),n=this._bucketOptions(e);return this.client.paginatedList(t,e,n)}},{key:"listCollections",value:function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],t=(0,_endpoint2["default"])("collection",this.name),n=this._bucketOptions(e);return this.client.paginatedList(t,e,n)}},{key:"createCollection",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],n=this._bucketOptions(t),i=n.permissions,r=n.data,s=void 0===r?{}:r;s.id=e;var a=(0,_endpoint2["default"])("collection",this.name,e),u=requests.createRequest(a,{data:s,permissions:i},n);return this.client.execute(u)}},{key:"deleteCollection",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],n=(0,_utils.toDataBody)(e);if(!n.id)throw new Error("A collection id is required.");var i=n.id,r=n.last_modified,s=this._bucketOptions(_extends({last_modified:r},t)),a=(0,_endpoint2["default"])("collection",this.name,i),u=requests.deleteRequest(a,s);return this.client.execute(u)}},{key:"listGroups",value:function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],t=(0,_endpoint2["default"])("group",this.name),n=this._bucketOptions(e);return this.client.paginatedList(t,e,n)}},{key:"getGroup",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return this.client.execute({path:(0,_endpoint2["default"])("group",this.name,e),headers:_extends({},this.options.headers,t.headers)})}},{key:"createGroup",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?[]:arguments[1],n=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],i=this._bucketOptions(n),r=_extends({},n.data,{id:e,members:t}),s=(0,_endpoint2["default"])("group",this.name,e),a=n.permissions,u=requests.createRequest(s,{data:r,permissions:a},i);return this.client.execute(u)}},{key:"updateGroup",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];if(!(0,_utils.isObject)(e))throw new Error("A group object is required.");if(!e.id)throw new Error("A group id is required.");var n=this._bucketOptions(t),i=_extends({},t.data,e),r=(0,_endpoint2["default"])("group",this.name,e.id),s=t.permissions,a=requests.updateRequest(r,{data:i,permissions:s},n);return this.client.execute(a)}},{key:"deleteGroup",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],n=(0,_utils.toDataBody)(e),i=n.id,r=n.last_modified,s=this._bucketOptions(_extends({last_modified:r},t)),a=(0,_endpoint2["default"])("group",this.name,i),u=requests.deleteRequest(a,s);return this.client.execute(u)}},{key:"getPermissions",value:function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];return this.client.execute({path:(0,_endpoint2["default"])("bucket",this.name),headers:_extends({},this.options.headers,e.headers)}).then(function(e){return e.permissions})}},{key:"setPermissions",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];if(!(0,_utils.isObject)(e))throw new Error("A permissions object is required.");var n=(0,_endpoint2["default"])("bucket",this.name),i=_extends({},this._bucketOptions(t)),r=t.last_modified,s={last_modified:r},a=requests.updateRequest(n,{data:s,permissions:e},i);return this.client.execute(a)}},{key:"batch",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return this.client.batch(e,this._bucketOptions(t))}}]),e}(),_applyDecoratedDescriptor(_class.prototype,"listHistory",[_dec],Object.getOwnPropertyDescriptor(_class.prototype,"listHistory"),_class.prototype),_class);exports["default"]=Bucket;

},{"./collection":9,"./endpoint":10,"./requests":14,"./utils":15}],9:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{"default":e}}function _interopRequireWildcard(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _applyDecoratedDescriptor(e,t,n,r,i){var s={};return Object.keys(r).forEach(function(e){s[e]=r[e]}),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},s),i&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(i):void 0,s.initializer=void 0),void 0===s.initializer&&(Object.defineProperty(e,t,s),s=null),s}Object.defineProperty(exports,"__esModule",{value:!0}),exports["default"]=void 0;var _extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),_dec,_dec2,_desc,_value,_class,_uuid=require("uuid"),_utils=require("./utils"),_requests=require("./requests"),requests=_interopRequireWildcard(_requests),_endpoint=require("./endpoint"),_endpoint2=_interopRequireDefault(_endpoint),Collection=(_dec=(0,_utils.capable)(["attachments"]),_dec2=(0,_utils.capable)(["attachments"]),_class=function(){function e(t,n,r){var i=arguments.length<=3||void 0===arguments[3]?{}:arguments[3];_classCallCheck(this,e),this.client=t,this.bucket=n,this.name=r,this.options=_extends({},this.bucket.options,i,{headers:_extends({},this.bucket.options&&this.bucket.options.headers,i.headers)}),this._isBatch=!!i.batch}return _createClass(e,[{key:"_collOptions",value:function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],t=_extends({},this.options&&this.options.headers,e.headers);return _extends({},this.options,e,{headers:t})}},{key:"getTotalRecords",value:function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],t=this._collOptions(e),n=t.headers;return this.client.execute({method:"HEAD",path:(0,_endpoint2["default"])("record",this.bucket.name,this.name),headers:n},{raw:!0}).then(function(e){var t=e.headers;return parseInt(t.get("Total-Records"),10)})}},{key:"getData",value:function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],t=this._collOptions(e),n=t.headers;return this.client.execute({path:(0,_endpoint2["default"])("collection",this.bucket.name,this.name),headers:n}).then(function(e){return e.data})}},{key:"setData",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];if(!(0,_utils.isObject)(e))throw new Error("A collection object is required.");var n=this._collOptions(t),r=n.permissions,i=(0,_endpoint2["default"])("collection",this.bucket.name,this.name),s=requests.updateRequest(i,{data:e,permissions:r},n);return this.client.execute(s)}},{key:"getPermissions",value:function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],t=this._collOptions(e),n=t.headers;return this.client.execute({path:(0,_endpoint2["default"])("collection",this.bucket.name,this.name),headers:n}).then(function(e){return e.permissions})}},{key:"setPermissions",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];if(!(0,_utils.isObject)(e))throw new Error("A permissions object is required.");var n=this._collOptions(t),r=(0,_endpoint2["default"])("collection",this.bucket.name,this.name),i={last_modified:t.last_modified},s=requests.updateRequest(r,{data:i,permissions:e},n);return this.client.execute(s)}},{key:"createRecord",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],n=this._collOptions(t),r=n.permissions,i=(0,_endpoint2["default"])("record",this.bucket.name,this.name,e.id),s=requests.createRequest(i,{data:e,permissions:r},n);return this.client.execute(s)}},{key:"addAttachment",value:function(e){var t=this,n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],r=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],i=this._collOptions(r),s=i.permissions,a=n.id||_uuid.v4.v4(),u=(0,_endpoint2["default"])("attachment",this.bucket.name,this.name,a),o=requests.addAttachmentRequest(u,e,{data:n,permissions:s},i);return this.client.execute(o,{stringify:!1}).then(function(){return t.getRecord(a)})}},{key:"removeAttachment",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],n=this._collOptions(t),r=(0,_endpoint2["default"])("attachment",this.bucket.name,this.name,e),i=requests.deleteRequest(r,n);return this.client.execute(i)}},{key:"updateRecord",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];if(!(0,_utils.isObject)(e))throw new Error("A record object is required.");if(!e.id)throw new Error("A record id is required.");var n=this._collOptions(t),r=n.permissions,i=(0,_endpoint2["default"])("record",this.bucket.name,this.name,e.id),s=requests.updateRequest(i,{data:e,permissions:r},n);return this.client.execute(s)}},{key:"deleteRecord",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],n=(0,_utils.toDataBody)(e);if(!n.id)throw new Error("A record id is required.");var r=n.id,i=n.last_modified,s=this._collOptions(_extends({last_modified:i},t)),a=(0,_endpoint2["default"])("record",this.bucket.name,this.name,r),u=requests.deleteRequest(a,s);return this.client.execute(u)}},{key:"getRecord",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return this.client.execute(_extends({path:(0,_endpoint2["default"])("record",this.bucket.name,this.name,e)},this._collOptions(t)))}},{key:"listRecords",value:function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],t=(0,_endpoint2["default"])("record",this.bucket.name,this.name),n=this._collOptions(e);return this.client.paginatedList(t,e,n)}},{key:"batch",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],n=this._collOptions(t);return this.client.batch(e,_extends({},n,{bucket:this.bucket.name,collection:this.name}))}}]),e}(),_applyDecoratedDescriptor(_class.prototype,"addAttachment",[_dec],Object.getOwnPropertyDescriptor(_class.prototype,"addAttachment"),_class.prototype),_applyDecoratedDescriptor(_class.prototype,"removeAttachment",[_dec2],Object.getOwnPropertyDescriptor(_class.prototype,"removeAttachment"),_class.prototype),_class);exports["default"]=Collection;

},{"./endpoint":10,"./requests":14,"./utils":15,"uuid":5}],10:[function(require,module,exports){
"use strict";function endpoint(t){for(var n=arguments.length,r=Array(n>1?n-1:0),e=1;n>e;e++)r[e-1]=arguments[e];return ENDPOINTS[t].apply(ENDPOINTS,r)}Object.defineProperty(exports,"__esModule",{value:!0}),exports["default"]=endpoint;var ENDPOINTS={root:function(){return"/"},batch:function(){return"/batch"},permissions:function(){return"/permissions"},bucket:function(t){return"/buckets"+(t?"/"+t:"")},history:function(t){return ENDPOINTS.bucket(t)+"/history"},collection:function(t,n){return ENDPOINTS.bucket(t)+"/collections"+(n?"/"+n:"")},group:function(t,n){return ENDPOINTS.bucket(t)+"/groups"+(n?"/"+n:"")},record:function(t,n,r){return ENDPOINTS.collection(t,n)+"/records"+(r?"/"+r:"")},attachment:function(t,n,r){return ENDPOINTS.record(t,n,r)+"/attachment"}};

},{}],11:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports["default"]={104:"Missing Authorization Token",105:"Invalid Authorization Token",106:"Request body was not valid JSON",107:"Invalid request parameter",108:"Missing request parameter",109:"Invalid posted data",110:"Invalid Token / id",111:"Missing Token / id",112:"Content-Length header was not provided",113:"Request body too large",114:"Resource was created, updated or deleted meanwhile",115:"Method not allowed on this end point (hint: server may be readonly)",116:"Requested version not available on this server",117:"Client has sent too many requests",121:"Resource access is forbidden for this user",122:"Another resource violates constraint",201:"Service Temporary unavailable due to high load",202:"Service deprecated",999:"Internal Server Error"};

},{}],12:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{"default":e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0}),exports["default"]=void 0;var _extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},_createClass=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),_errors=require("./errors"),_errors2=_interopRequireDefault(_errors),HTTP=function(){function e(t){var r=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];if(_classCallCheck(this,e),!t)throw new Error("No events handler provided");this.events=t,this.requestMode=r.requestMode||e.defaultOptions.requestMode,this.timeout=r.timeout||e.defaultOptions.timeout}return _createClass(e,null,[{key:"DEFAULT_REQUEST_HEADERS",get:function(){return{Accept:"application/json","Content-Type":"application/json"}}},{key:"defaultOptions",get:function(){return{timeout:5e3,requestMode:"cors"}}}]),_createClass(e,[{key:"request",value:function(t){var r=this,n=arguments.length<=1||void 0===arguments[1]?{headers:{}}:arguments[1],o=void 0,a=void 0,s=void 0,u=void 0,i=void 0;return n.headers=_extends({},e.DEFAULT_REQUEST_HEADERS,n.headers),n.body&&"function"==typeof n.body.append&&delete n.headers["Content-Type"],n.mode=this.requestMode,new Promise(function(e,o){var a=setTimeout(function(){i=!0,o(new Error("Request timeout."))},r.timeout);fetch(t,n).then(function(t){i||(clearTimeout(a),e(t))})["catch"](function(e){i||(clearTimeout(a),o(e))})}).then(function(e){return o=e,u=e.headers,a=e.status,s=e.statusText,r._checkForDeprecationHeader(u),r._checkForBackoffHeader(a,u),r._checkForRetryAfterHeader(a,u),e.text()}).then(function(e){return 0===e.length?null:JSON.parse(e)})["catch"](function(e){var t=new Error("HTTP "+(a||0)+"; "+e);throw t.response=o,t.stack=e.stack,t}).then(function(e){if(e&&a>=400){var t="HTTP "+a+" "+(e.error||"")+": ";if(e.errno&&e.errno in _errors2["default"]){var r=_errors2["default"][e.errno];t+=r,e.message&&e.message!==r&&(t+=" ("+e.message+")")}else t+=s||"";var n=new Error(t.trim());throw n.response=o,n.data=e,n}return{status:a,json:e,headers:u}})}},{key:"_checkForDeprecationHeader",value:function(e){var t=e.get("Alert");if(t){var r=void 0;try{r=JSON.parse(t)}catch(n){return void console.warn("Unable to parse Alert header message",t)}console.warn(r.message,r.url),this.events.emit("deprecated",r)}}},{key:"_checkForBackoffHeader",value:function(e,t){var r=void 0,n=parseInt(t.get("Backoff"),10);r=n>0?(new Date).getTime()+1e3*n:0,this.events.emit("backoff",r)}},{key:"_checkForRetryAfterHeader",value:function(e,t){var r=t.get("Retry-After");r&&(r=(new Date).getTime()+1e3*parseInt(r,10),this.events.emit("retry-after",r))}}]),e}();exports["default"]=HTTP;

},{"./errors":11}],13:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{"default":e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports["default"]=void 0;var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};require("isomorphic-fetch");var _events=require("events"),_base=require("./base"),_base2=_interopRequireDefault(_base),KintoClient=function(e){function t(e){var o=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];_classCallCheck(this,t);var n=o.events||new _events.EventEmitter;return _possibleConstructorReturn(this,Object.getPrototypeOf(t).call(this,e,Object.assign({events:n},o)))}return _inherits(t,e),t}(_base2["default"]);exports["default"]=KintoClient,"object"===("undefined"==typeof module?"undefined":_typeof(module))&&(module.exports=KintoClient);

},{"./base":6,"events":1,"isomorphic-fetch":2}],14:[function(require,module,exports){
"use strict";function safeHeader(e,t){return e?t?{"If-Match":'"'+t+'"'}:{"If-None-Match":"*"}:{}}function createRequest(e,t){var s=t.data,a=t.permissions,r=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],d=_extends({},requestDefaults,r),n=d.headers,u=d.safe;return{method:s&&s.id?"PUT":"POST",path:e,headers:_extends({},n,safeHeader(u)),body:{data:s,permissions:a}}}function updateRequest(e,t){var s=t.data,a=t.permissions,r=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],d=_extends({},requestDefaults,r),n=d.headers,u=d.safe,i=d.patch,o=_extends({},s,r),m=o.last_modified;return 0===Object.keys((0,_utils.omit)(s,"id","last_modified")).length&&(s=void 0),{method:i?"PATCH":"PUT",path:e,headers:_extends({},n,safeHeader(u,m)),body:{data:s,permissions:a}}}function deleteRequest(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],s=_extends({},requestDefaults,t),a=s.headers,r=s.safe,d=s.last_modified;if(r&&!d)throw new Error("Safe concurrency check requires a last_modified value.");return{method:"DELETE",path:e,headers:_extends({},a,safeHeader(r,d))}}function addAttachmentRequest(e,t){var s=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],a=s.data,r=s.permissions,d=arguments.length<=3||void 0===arguments[3]?{}:arguments[3],n=_extends({},requestDefaults,d),u=n.headers,i=n.safe,o=_extends({},a,d),m=o.last_modified;if(i&&!m)throw new Error("Safe concurrency check requires a last_modified value.");var f={data:a,permissions:r},h=(0,_utils.createFormData)(t,f,d);return{method:"POST",path:e,headers:_extends({},u,safeHeader(i,m)),body:h}}Object.defineProperty(exports,"__esModule",{value:!0});var _extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e};exports.createRequest=createRequest,exports.updateRequest=updateRequest,exports.deleteRequest=deleteRequest,exports.addAttachmentRequest=addAttachmentRequest;var _utils=require("./utils"),requestDefaults={safe:!1,headers:{},permissions:void 0,data:void 0,patch:!1};

},{"./utils":15}],15:[function(require,module,exports){
"use strict";function _defineProperty(r,t,e){return t in r?Object.defineProperty(r,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):r[t]=e,r}function _toArray(r){return Array.isArray(r)?r:Array.from(r)}function partition(r,t){return 0>=t?r:r.reduce(function(r,e,n){return 0===n||n%t===0?r.push([e]):r[r.length-1].push(e),r},[])}function pMap(r,t){var e=[];return r.reduce(function(r,n){return r.then(function(){return Promise.resolve(t(n)).then(function(r){return e=e.concat(r)})})},Promise.resolve()).then(function(){return e})}function omit(r){for(var t=arguments.length,e=Array(t>1?t-1:0),n=1;t>n;n++)e[n-1]=arguments[n];return Object.keys(r).reduce(function(t,n){return-1===e.indexOf(n)&&(t[n]=r[n]),t},{})}function toDataBody(r){if(isObject(r))return r;if("string"==typeof r)return{id:r};throw new Error("Invalid argument.")}function qsify(r){var t=function(r){return encodeURIComponent("boolean"==typeof r?String(r):r)},e=function(r){return JSON.parse(JSON.stringify(r))},n=e(r);return Object.keys(n).map(function(r){var e=t(r)+"=";return Array.isArray(n[r])?e+n[r].map(function(r){return t(r)}).join(","):e+t(n[r])}).join("&")}function checkVersion(r,t,e){var n=function(r){return r.split(".").map(function(r){return parseInt(r,10)})},o=n(r),a=_slicedToArray(o,2),i=a[0],u=a[1],c=n(t),f=_slicedToArray(c,2),s=f[0],p=f[1],l=n(e),y=_slicedToArray(l,2),b=y[0],h=y[1],v=[s>i,i===s&&p>u,i>b,i===b&&u>=h];if(v.some(function(r){return r}))throw new Error("Version "+r+" doesn't satisfy "+(t+" <= x < "+e))}function support(r,t){return function(e,n,o){var a=o.value;return{configurable:!0,get:function(){var e=this,o=function(){for(var n=arguments.length,o=Array(n),i=0;n>i;i++)o[i]=arguments[i];var u="client"in e?e.client:e;return u.fetchHTTPApiVersion().then(function(e){return checkVersion(e,r,t)}).then(function(){return a.apply(e,o)})};return Object.defineProperty(this,n,{value:o,configurable:!0,writable:!0}),o}}}}function capable(r){return function(t,e,n){var o=n.value;return{configurable:!0,get:function(){var t=this,n=function(){for(var e=arguments.length,n=Array(e),a=0;e>a;a++)n[a]=arguments[a];var i="client"in t?t.client:t;return i.fetchServerCapabilities().then(function(t){var e=r.filter(function(r){return!t.hasOwnProperty(r)});if(e.length>0)throw new Error("Required capabilities "+e.join(", ")+" not present on server")}).then(function(){return o.apply(t,n)})};return Object.defineProperty(this,e,{value:n,configurable:!0,writable:!0}),n}}}}function nobatch(r){return function(t,e,n){var o=n.value;return{configurable:!0,get:function(){var t=this,n=function(){for(var e=arguments.length,n=Array(e),a=0;e>a;a++)n[a]=arguments[a];if(t._isBatch)throw new Error(r);return o.apply(t,n)};return Object.defineProperty(this,e,{value:n,configurable:!0,writable:!0}),n}}}}function isObject(r){return"object"===("undefined"==typeof r?"undefined":_typeof(r))&&null!==r&&!Array.isArray(r)}function parseDataURL(r){var t=/^data:(.*);base64,(.*)/,e=r.match(t);if(!e)throw new Error("Invalid data-url: "+String(r).substr(0,32)+"...");var n=e[1],o=e[2],a=n.split(";"),i=_toArray(a),u=i[0],c=i.slice(1),f=c.reduce(function(r,t){var e=t.split("="),n=_slicedToArray(e,2),o=n[0],a=n[1];return _extends({},r,_defineProperty({},o,a))},{});return _extends({},f,{type:u,base64:o})}function extractFileInfo(r){for(var t=parseDataURL(r),e=t.name,n=t.type,o=t.base64,a=atob(o),i=[],u=0;u<a.length;u++)i.push(a.charCodeAt(u));var c=new Blob([new Uint8Array(i)],{type:n});return{blob:c,name:e}}function createFormData(r,t){var e=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],n=e.filename,o=void 0===n?"untitled":n,a=extractFileInfo(r),i=a.blob,u=a.name,c=new FormData;c.append("attachment",i,u||o);for(var f in t)"undefined"!=typeof t[f]&&c.append(f,JSON.stringify(t[f]));return c}Object.defineProperty(exports,"__esModule",{value:!0});var _extends=Object.assign||function(r){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n])}return r},_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(r){return typeof r}:function(r){return r&&"function"==typeof Symbol&&r.constructor===Symbol?"symbol":typeof r},_slicedToArray=function(){function r(r,t){var e=[],n=!0,o=!1,a=void 0;try{for(var i,u=r[Symbol.iterator]();!(n=(i=u.next()).done)&&(e.push(i.value),!t||e.length!==t);n=!0);}catch(c){o=!0,a=c}finally{try{!n&&u["return"]&&u["return"]()}finally{if(o)throw a}}return e}return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return r(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();exports.partition=partition,exports.pMap=pMap,exports.omit=omit,exports.toDataBody=toDataBody,exports.qsify=qsify,exports.checkVersion=checkVersion,exports.support=support,exports.capable=capable,exports.nobatch=nobatch,exports.isObject=isObject,exports.parseDataURL=parseDataURL,exports.extractFileInfo=extractFileInfo,exports.createFormData=createFormData;

},{}]},{},[13])(13)
});