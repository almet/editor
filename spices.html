<h2>Houblons</h2>

<div class="btn-toolbar">
  <div class="btn-group">
    <button class="btn btn-default" ng-click="recipe.spices.push({});">
      <span class="glyphicon glyphicon-plus-sign"></span>
    </button>
  </div>
  <div class="btn-group" ng-repeat="type in spicesTypes" uib-dropdown>
    <button class="btn btn-default" uib-dropdown-toggle>
      <span class="glyphicon glyphicon-plus-sign"></span>
      {{ type.name }} <span class="caret"></span>
    </button>
    <ul class="dropdown-menu" uib-dropdown-menu>
      <li ng-repeat="s in spices | filter:type.filter">
        <a ng-click="recipe.spices.push(copy(s));"
           ng-bind="s.name"></a></li>
    </ul>
  </div>
</div>

<div class="row">
  <div class="col-sm-10">
    <table class="table table-bordered" ng-show="recipe.spices.length > 0">
      <thead>
        <th>Nom</th>
        <th>%AA</th>
        <th>kg</th>
        <th>mn</th>
        <th>IBU</th>
        <th class="col-md-1"></th>
      </thead>
      <tbody>
        <tr ng-repeat="s in recipe.spices"
            ng-init="show=false" ng-mouseenter="show=true"
            ng-mouseleave="show=false">
          <td>
            <input class="form-control" ng-model="s.name" />
          </td>
          <td>
            <input type="number" step="any" class="form-control" ng-model="s.aa" />
          </td>
          <td>
            <input type="number" step="any" class="form-control" ng-model="s.weight" />
          </td>
          <td>
            <input class="form-control" ng-model="s.time"
                   ng-blur="recipe.spices = orderBy(['-time','aa','name'])" />
          </td>
          <td>{{ spiceBitterness(s, calculations) | number:1 }}</td>
          <td>
            <button ng-click="remove(recipe.spices, s)" ng-show="show"
                    class="btn btn-danger btn-xs">
              <span class="glyphicon glyphicon-minus-sign"></span>
            </button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="col-md-2">
    <dl>
      <dt>Amertume Absolue</dt>
      <dd>{{ calculations.ibu | number:1 }} IBU</dd>
      <dt>Amertume Relative</dt>
      <dd>{{ calculations.buToGu | number:1 }} BU:GU</dd>
    </dl>
  </div>
</div>
